<div class="donations">
  <div class="col-md-6 col-md-offset-6">
    <a id="exportDonationsButton"
           class="btn btn-primary btn-export"
           ng-click="donCtrl.exportToExcel()">Export data</a>
        <input class="table-search" ng-model="donCtrl.donationSearch" placeholder="Search">
  </div>
  <table id="donations"
         class="impact-table"
         style="margin-top: 20px;">
    <tr>
      <td><p>Name<sort action="donCtrl.sort" field="fullName" style="margin-left: 10px;"></sort></p></td>
      <td><p>Email<sort action="donCtrl.sort" field="email" style="margin-left: 10px;"></sort></p></td>
      <td><p>Donated<sort action="donCtrl.sort" field="donated" style="margin-left: 10px;"></sort></p></td>
      <td><p>Date<sort action="donCtrl.sort" field="date" style="margin-left: 10px;"></sort></p></td>
      <td><p>Received <br>Upfront ({{ donCtrl.upfrontPayment }}%)<sort action="donCtrl.sort" field="upfront" style="margin-left: 10px;"></sort></p></td>
      <td><p>Received On<br> Validation<sort action="donCtrl.sort" field="paidOut" style="margin-left: 10px;"></sort></p></td>
      <td><p>Total <br>Received<sort action="donCtrl.sort" field="totalPaidOut" style="margin-left: 10px;"></sort></p></td>
      <td><p>Gift Aid<sort action="donCtrl.sort" field="giftAid" style="margin-left: 10px;"></sort></p></td>
    </tr>
    <tr ng-repeat="donation in donCtrl.users.slice(((currentPage - 1) * itemsPerPage),
                   ((currentPage) * itemsPerPage))
                   | filter: donCtrl.donationSearch
                   | orderBy : donCtrl.sortField"
        class="donation-row">
        <td>{{donation.fullName}}</td>
        <td>{{donation.email}}</td>
        <td>{{donation.donated | money}}</td>
        <td>{{donation.date | date}}</td>
        <td>{{donation.receivedUpfront | money : '0'}}</td>
        <td>{{donation.receviedForDonation | money : '0'}}</td>
        <td>{{donation.totalReceived | money : '0'}}</td>
        <td><a ng-click="donCtrl.openGiftAidAddress(donation)">{{donation.giftAidAddress ? 'Show' : ''}}</a><span ng-hide="donation.giftAidAddress">No</span></td>
    </tr>
  </table>
  <div uib-pagination
       total-items="donCtrl.totalItems"
       ng-model="currentPage"
       max-size="maxSize"
       class="pagination-sm"
       boundary-link-numbers="true"
       rotate="false">
  </div>


  <!-- Only used for exporting donations -->
  <table ng-show="false"
         id="donations-export">
    <tr>
      <td><p>Name<sort action="donCtrl.sort" field="fullName"></sort></p></td>
      <td><p>Email<sort action="donCtrl.sort" field="email"></sort></p></td>
      <td><p>Donated<sort action="donCtrl.sort" field="donated"></sort></p></td>
      <td><p>Date<sort action="donCtrl.sort" field="date"></sort></p></td>
      <td><p>Received<sort action="donCtrl.sort" field="paidOut"></sort></p></td>
      <td><p>Gift Aid<sort action="donCtrl.sort" field="giftAid"></sort></p></td>
      <td><p>Contact<sort action="donCtrl.sort" field="agreeContact"></sort></p></td>
    </tr>
    <tr ng-repeat="donation in donCtrl.users
                   | filter: donCtrl.donationSearch
                   | orderBy : donCtrl.sortField"
        class="donation-row">
        <td>{{donation.fullName}}</td>
        <td>{{donation.email}}</td>
        <td>{{donation.donated | money}}</td>
        <td>{{donation.date | date}}</td>
        <td>{{donation.receviedForDonation | money : '0'}}</td>
        <td>{{donation.giftAidAddress ? donation.giftAidAddress : 'No'}}</td>
        <td>{{donation.agreeContact ? 'Yes' : 'No'}}</td>
    </tr>
  </table>
</div>
